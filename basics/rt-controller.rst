RTコンポーネントのコントローラの接続
=====================================


ここではJVRCモデルにRTコンポーネントのコントローラを接続し、ロボットの関節角度を取得できるようにします。

プロジェクトを開く
------------------

「メニュー」の「プロジェクトの読み込み」から JVRC モデルファイル用のプロジェク
トファイルを読み込みます。プロジェクトファイル名は「モデルファイルのインス
トール」でダウンロードしたリポジトリの「model/robot/samples/sample1.cnoid」です。

コントローラの追加
------------------

まずアイテムビューで「World」を選択します。
次に、「メニュー」の「ファイル」「新規」より「BodyRTC」を選択し「BodyRTC」とい
う名前で追加します。

コントローラのソースコード
--------------------------

コントローラのソースコードは以下になります。 ::

コントローラのヘッダのソースコードは以下になります。 ::

このソースコードは 「モデルファイルのインストール」でダウンロードしたリポジトリ
の「model/robot/RTC/RobotControllerRTC.cpp」と
「model/robot/RTC/RobotControllerRTC.h」に保存されています。

コントローラのビルド
--------------------

「モデルファイルのインストール」でダウンロードしたリポジトリの
「model/robot/RTC/」ディレクトリに移動し、make コマンドを実行します。

「model/robot/RTC/」ディレクトリに「RobotControllerRTC.so」というファイルが作成
されるはずです。

コントローラの設定
------------------

プロジェクト上で RT コンポーネント(RTC) を作成しただけでは、ロボットの制御を行
うことができません。

アイテムビューで「BodyRTC」を選択するとプロパティのタブ(プロパティビューと言い
ます)にRTCの設定が表示されます。
プロパティビューの「コントローラのモジュール名」を「RTC/RobotControllerRTC」と
します。これは「コントローラのビルド」で作成したモジュールのパスと対応していま
す。

シミュレーションを実行する
--------------------------

シミュレーションツールバーの「シミュレーション開始ボタン」を押します。
シミュレーションを実行するとメッセージ画面に関節角度が表示されるはずです。

.. image:: images/simulation_no_controller.png

このようにして得られる関節角度を基にトルクをロボットに入力することでロボットの
制御を行うことができます。この後のサンプルで詳しく解説します。

サンプルプロジェクトについて
----------------------------

このサンプルのプロジェクトファイルは「モデルファイルのインストール」でダウン
ロードしたリポジトリの「model/robot/samples/sample2.cnoid」に保存されています。

.. toctree::
   :maxdepth: 2

